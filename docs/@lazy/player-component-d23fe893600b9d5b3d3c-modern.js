(window.webpackJsonp=window.webpackJsonp||[]).push([[4,7,9,10],[,,,function(t,e,n){"use strict";n.r(e);var s=n(1);e.default="assign"in s.a?s.a.assign:function(t){for(let e=1;e<arguments.length;e++){const n=arguments[e];for(const e in n)s.c.call(n,e)&&(t[e]=n[e])}return t}},,,,,,,,,,function(t,e,n){"use strict";n.r(e),n.d(e,"Requests",(function(){return o}));var s=n(2);const o={async get(t,e=!0,n={}){let o;return o=e?`${s.a}${t}`:t,await fetch(o,{headers:n,credentials:"include"})},async post(t,e=!0,n,o={"content-type":"application/x-www-form-urlencoded"}){let i,r;return r="application/json"===o["content-type"].toLowerCase()&&"object"==typeof n?JSON.stringify(n):n,i=e?`${s.a}${t}`:t,await fetch(i,{method:"post",body:r,headers:o,credentials:"include"})}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var s=n(0);function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class i extends s.i{constructor(...t){super(...t),o(this,"state",{isFocused:!1,value:""}),o(this,"onFocus",()=>!this.state.value&&this.setState({isFocused:!0})),o(this,"onBlur",()=>!this.state.value&&this.setState({isFocused:!1})),o(this,"onInput",t=>this.setState({value:t.target.value})),o(this,"onSubmit",()=>this.props.onSubmit(this.state.value))}render({id:t,buttonText:e="search",labelText:n="search for shows",onInput:o,wssResponse:i},{isFocused:a}){const c=["_animate",a?"moveup":"movedown"];return Object(s.h)("div",{class:"search-component"},Object(s.h)("form",{action:"javascript:",onSubmit:this.onSubmit},Object(s.h)("label",{class:c,for:t},n),Object(s.h)(r,{onFocus:this.onFocus,onBlur:this.onBlur,id:t,onInput:t=>{this.onInput(t),null!=o&&o(t)}}),i,Object(s.h)("button",{class:"search-button"},e)))}}function r({onFocus:t,onBlur:e,onInput:n,id:o}){return Object(s.h)("input",{onFocus:t,onBlur:e,onInput:n,id:o,class:"paper-input"})}},function(t,e,n){"use strict";var s=n(0),o=n(14),i=n(2);class r{__defaultOnMessage(t){if(["ping","pong"].includes(t.data))return;const e=JSON.parse(t.data);this._socketID=e.socket_id}startConn(t){return this.socket&&[WebSocket.OPEN,WebSocket.CONNECTING].includes(this.socket.readyState)?this.socket:new Promise((e,n)=>{this.socket=new WebSocket(Object(i.h)(t)),this.socket.onopen=()=>{this.socket.onmessage=this.__defaultOnMessage,e(this.socket)},this.socket.onerror=t=>n(t)})}close(){try{this.socket.close()}catch(t){console.warn(t)}}send(t){return this.socket.send(JSON.stringify(t))}sendString(t){return this.socket.send(t)}set onmessage(t){t!==this._onmessage&&(this._onmessage=t,this.socket.onmessage=t=>{const e=JSON.parse(t.data||"{}");return"ping"===e.type||"pong"===e.type?void 0:this._onmessage(e)})}get readyState(){return this.socket.readyState}get isUsable(){return!this.socket||[WebSocket.OPEN,WebSocket.CONNECTING].includes(this.socket.readyState)}get isConnected(){return!!this.socket&&[WebSocket.OPEN,WebSocket.CONNECTING].includes(this.socket.readyState)}}let a;const c=()=>(a||{}).isUsable?a:a=new r;function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}let l;class h extends s.i{constructor(...t){super(...t),u(this,"state",{resp:[],prevVal:""}),u(this,"onMessage",t=>{t.data?this.setState({resp:t.data.map(t=>({movie:t.movie,href:Object(i.e)(t.id,t.movie)}))}):this.setState({resp:[]})}),u(this,"componentWillUpdate",Object(i.b)(this.fetchResponses,100,!1,this)),u(this,"componentWillMount",this.componentWillUpdate)}async fetchResponses(){const t=this.props.val;t!=this.state.prevVal&&t?(console.log("fetching"),this.setState({prevVal:t}),l=c(),await l.startConn("suggestqueries"),l.onmessage=this.onMessage,l.sendString(t)):this.state.resp.length&&!t&&this.setState({resp:[],prevVal:""})}render(){const t=["response-parent"];return this.state.resp.length&&t.push("has-data"),Object(s.h)("div",{class:t},this.state.resp.map(t=>Object(s.h)(s.a,{class:["movie-link","query-response"],href:t.href},Object(i.c)(t.movie))))}}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,"a",(function(){return p}));class p extends s.i{constructor(...t){super(...t),d(this,"state",{value:""}),d(this,"onInput",t=>{const e=(t.target.value||"").trim();document.title=e?`Search for ${e}`:i.d,this.setState({value:e})}),d(this,"loadSearchResults",()=>{const t=(this.state.value||"").trim();t&&Object(i.g)(t),this.setState({value:""})})}componentWillMount(){c().startConn("suggestqueries")}render(){return Object(s.h)(s.d,null,Object(s.h)(o.a,{id:"landing-search-component",onSubmit:this.loadSearchResults,wssResponse:Object(s.h)(h,{val:this.state.value}),onInput:this.onInput}))}}},,function(t,e,n){"use strict";var s=n(1);let o=Object(s.e)();const i=Object(s.b)("Map",o),r=(Object(s.b)("Set",o),Object(s.b)("WeakMap",o)&&Object(s.b)("WeakSet",o),"__@@map"),a=t=>t!=t,c=(t,e)=>t===e||a(t)&&a(e),u=t=>0===t?0:t;let l,h,d;if("undefined"!=typeof Symbol){function p(t,e){const n=t[r];let s=0;const o=n.length,i=e?0:1;return{[Symbol.iterator]:function(){return this},next:function(){return s<o?{value:n[s++][i],done:!1}:{value:void 0,done:!0}}}}l=function(){return this[r][Symbol.iterator]()},h=function(){return p(this,!1)},d=function(){return p(this,!0)}}else l=d=h=function(){console.warn("no symbol support")};var b={keys:d,values:h,entries:l},f=n(3);function m(t,e){const n=t[r],s=n.length;for(let t=0;t<s;t++){const s=n[t];if(c(s[0],e))return s}return null}function g(t,e){if(n=t,!(null!=(s=e)&&"undefined"!=typeof Symbol&&s[Symbol.hasInstance]?s[Symbol.hasInstance](n):n instanceof s))throw new TypeError("Cannot call a class as a function");var n,s}const v=function t(e,n){return g(this,t),!n&&i?new Map(e):(this[r]=[],function(t,e){if(null==e)return;if(!Object(s.d)(e))throw new Error("value:"+String(e)+" is not iterable");const n=e.length;for(let s=0;s<n;s++){const n=e[s];if(!n||2!==n.length)throw new Error("invalid arg");t.set(n[0],n[1])}}(this,e),this)};var y;(y=v).prototype.set=function(t,e){const n=m(this,t);return n?n[1]=e:this[r].push([u(t),e]),this},y.prototype.has=function(t){return!!m(this,t)},y.prototype.delete=function(t){let e=!1;return this[r]=this[r].filter(n=>{const s=!c(n[0],t);return s||(e=!0),s}),e},y.prototype.get=function(t){const e=m(this,t);return e?e[1]:void 0},y.prototype.forEach=function(t,e){const n=this[r],s=n.length;for(let o=0;o<s;o++){const s=n[o],i=s[1],r=s[0],a=this;e?t.call(e,i,r,a):t(i,r,a)}},y.prototype.clear=function(){this[r].length=0},Object.defineProperty(y.prototype,"size",{enumerable:!1,configurable:!0,get:function(){return this[r].length}}),"undefined"!=typeof Symbol&&(y.prototype[Symbol.iterator]=b.entries,y.prototype[Symbol.toStringTag]="Map"),Object(f.default)(y.prototype,b),v[Symbol.species]=v;e.a=v},,function(t,e,n){"use strict";n.r(e),n.d(e,"LoadingSpinner",(function(){return i})),n.d(e,"default",(function(){return i}));var s=n(0);let o;if(window.customElements){const t="size",e=document.createElement("template");e.innerHTML='<style>.spinner{margin:auto;height: 50px; width: 50px; animation: rotate 0.8s infinite linear; border: 6px solid var(--background-color); border-right-color: var(--primary-color); border-radius: 50%;}@keyframes rotate{from{transform: rotate(0deg);}to{transform: rotate(360deg);}}</style><div class="spinner"></div>';const n=(t,e,n=e)=>{Object.defineProperty(t,n,{enumerable:!0,get(){const t=this.getAttribute(e);return null===t?"":t},set(t){this.setAttribute(e,t)}})};!window.customElements.get("loading-spinner")&&window.customElements.define("loading-spinner",class extends HTMLElement{constructor(){super();const s=e.content.cloneNode(!0),o=this.attachShadow({mode:"open"});o.appendChild(s),n(this,t),this.div=o.querySelector(".spinner")}static get observedAttributes(){return[t]}attributeChangedCallback(e,n,s){if(e===t&&s!==n){const t=this.div.style;t.height=t.width="string"==typeof s&&s.includes("px")?s:`${s}px`}}}),o=Object(s.h)("loading-spinner",{size:55})}else o="Connecting to the server";function i(){return Object(s.h)(s.d,null,o)}},,,,,,function(t,e,n){"use strict";n.r(e);var s=n(0),o=n(15),i=n(19),r=n(13),a=n(17);const c="data:text/html;base64,PGh0bWw+PGhlYWQ+PC9oZWFkPjxib2R5IHN0eWxlPSJtYXJnaW46YXV0bztjb2xvcjogI2ZmZjt0ZXh0LWFsaWduOmNlbnRlcjtmb250LWZhbWlseTpzYW5zLXNlcmlmO2ZvbnQtd2VpZ2h0OmJvbGQ7YmFja2dyb3VuZC1jb2xvcjogIzAwMDsiPkxvYWRpbmcuLi48L2JvZHk+PC9odG1sPg==",u=new a.a;console.log("video player cache:",u);const l=t=>{if(!t||"none"===t.toLowerCase())return null;let e;try{(e=new URL(t,`${location.protocol}//${location.hostname}`)).protocol="https:",e=e.toString()}catch(n){e=t,t.startsWith("//")&&(e=`https:${e}`)}return e},h=async t=>{const e=await r.Requests.post("/api/get-show-metadata/",!0,{id:t},{"content-type":"application/json"}),n=await e.json();if(!n.movie_name||n.error)throw new Error;return{movie:n.movie_name,episode_meta:n.episode_meta}},d=Object(s.h)("div",null,"No show exists with the given ID"),p=async t=>{const e=u.get(t);if(e)return console.log("refreshing cache in background"),h(t).then(e=>u.set(t,e)),e;{const e=await h(t);return u.set(t,e),e}};function b(t){return new URL(t).hostname}var f=n(2);function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class g extends s.i{constructor(...t){super(...t),m(this,"state",{src:c,URLs:[],currentEp:0,previousEp:0}),m(this,"componentDidUpdate",this.componentDidMount),m(this,"setSrc",t=>this.setState({src:t})),m(this,"_update",()=>this.setState({src:c})),m(this,"setEpisode",(t,e)=>{this.setState(n=>({currentEp:t,previousEp:n.currentEp,URLs:e}))})}componentDidMount(){const t=this.props.movieName;if(t&&(document.title="Watch "+t),this.state.currentEp===this.state.previousEp&&0==this.state.currentEp)return j(1,this.setEpisode,this.props.id)();this.state.src!==c&&this.state.URLs.includes(this.state.src)||this.state.URLs.length&&this.setState({src:this.state.URLs[0]})}render({movieName:t,episodeMeta:e,id:n},{URLs:o,currentEp:i}){return Object(s.h)(s.d,null,Object(s.h)("h2",{style:{fontWeight:"bold"}},Object(f.c)(t)),Object(s.h)("h2",{style:{fontWeight:"bold"}},"Now Playing Episode: ",i),o&&o.map(t=>Object(s.h)(v,{url:t,onClick:this.setSrc})),Object(s.h)("iframe",{class:"frame-src",src:this.state.src}),Object(s.h)(O,{data:e,updater:this.setEpisode,id:n,up:this._update}),o&&o.map(t=>Object(s.h)(y,{href:t})))}}function v({url:t,onClick:e}){return t?Object(s.h)("button",{onClick(){e(t)},class:"url-selector-button",style:{cursor:"pointer"}},b(t)):null}function y({href:t}){if(!t)return null;const e=`/out?${Object(f.k)({u:t})}`;return Object(s.h)(s.a,{href:e,class:["download-url-component","search-button"]},"Download from: ",b(t))}function O({data:t,updater:e,id:n,up:o}){return Object(s.h)("div",null,Array.from({length:t}).map((t,i)=>Object(s.h)("button",{class:"selector-button",onClick:j(i+1,e,n,o)},"Episode:",i+1)))}function j(t,e,n,s){return async function(){s&&s();const o=await r.Requests.post("/api/build-player/ep/",!0,{mid:n,eid:t},{"content-type":"application/json"}),i=await o.json();return e(t,[i.url,i.alt1,i.alt2].map(l))}}function S(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class w extends s.i{constructor(...t){super(...t),S(this,"state",{badId:!1,fetchingDetails:!1,movieName:"",episodeMeta:0}),S(this,"componentDidUpdate",this.componentDidMount)}render({id:t},{badId:e,fetchingDetails:n,movieName:o,episodeMeta:r}){return e||!o&&!n?d:n?Object(s.h)("div",{"data-fetch":JSON.stringify(this.props)},"Loading TV Data",Object(s.h)("div",null,Object(s.h)(i.LoadingSpinner))):Object(s.h)(g,{movieName:o,id:t,episodeMeta:r})}componentDidMount(t){const e=this.props.id;if(e||this.setState({badId:!0}),!(this.state.fetchingDetails||t&&t.id===this.props.id))return this.setState({badId:!1,fetchingDetails:!0}),p(e).then(t=>this.setState({episodeMeta:t.episode_meta,badId:!1,fetchingDetails:!1,movieName:t.movie})).catch(t=>console.log(t)||this.setState({badId:!0,fetchingDetails:!1}))}}n.d(e,"default",(function(){return k}));class k extends s.i{constructor(...t){var e,n,s;super(...t),s={badId:!1},(n="state")in(e=this)?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s}get movieId(){return new URLSearchParams(s.e.getQs).get("id")}getChildren({},{badId:t}){const e=this.movieId;return t||!e?d:Object(s.h)(w,{id:e})}render(t,e){return Object(s.h)(s.d,null,Object(s.h)(o.a),Object(s.h)("section",{data:"player-component"},this.getChildren(t,e)))}}}]]);